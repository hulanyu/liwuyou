"use strict";require(["config"],function(){require(["jquery","template","cookie","load"],function(t,c,e){t.cookie.json=!0;var o=t.cookie("products")||[];if(0!==o.length){var r=c("cart_template",{products:o});t(".cart_body").html(r),t(".cart_body").on("click",".del",function(){if(confirm("确认删除？")){var c=t(this).parents(".product"),e=i(c.children(".id").text(),o);o.splice(e,1),t.cookie("products",o,{expires:7,path:"/"}),c.remove(),n()}}),t(".cart_body").on("click",".add,.minus",function(){var c=t(this).parents(".product"),e=i(c.children(".id").text(),o),r=o[e];if(t(this).is(".add"))r.amount++;else{if(r.amount<=1)return;r.amount--}t.cookie("products",o,{expires:7,path:"/"}),c.find(".amount_num").val(r.amount),c.children(".sub").text(r.amount*r.price),n()}),t(".cart_body").on("blur",".amount_num",function(){var c=t(this).parents(".product"),e=i(c.children(".id").text(),o),r=o[e];/^[1-9]\d*$/.test(t(this).val())?(amount=t(this).val(),t.cookie("products",o,{expires:7,path:"/"}),c.children(".sub").text(r.amount*r.price),n()):t(this).val(r.amount)}),t(".ck_all").click(function(){var c=t(this).prop("checked");t(".ck_product").prop("checked",c),n()}),t(".ck_product").click(function(){var c=t(".ck_product:checked").length===o.length;t(".ck_all").prop("checked",c),n()})}else t(".cart_body").html('购物车为空,请<a href="list.html">选购商品</a>');function i(c,e){var o=-1;return t.each(e,function(t,e){if(e.id==c)return o=t,!1}),o}function n(){var c=0;t(".ck_product:checked").each(function(e,o){c+=Number(t(this).parents(".product").children(".sub").text())}),t(".total .money").text(c.toFixed(2))}})});