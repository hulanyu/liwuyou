"use strict";require(["config"],function(){require(["jquery","template","cookie","load"],function(t,c,e){t.cookie.json=!0;var o=t.cookie("products")||[];if(0!==o.length){var n=c("cart_template",{products:o});t(".cart_body").html(n),t(".cart_body").on("click",".del",function(){if(confirm("确认删除？")){var c=t(this).parents(".product"),e=i(c.children(".id").text(),o);o.splice(e,1),t.cookie("products",o,{expires:7,path:"/"}),c.remove(),r()}}),t(".cart_body").on("click",".add,.minus",function(){var c=t(this).parents(".product"),e=i(c.children(".id").text(),o),n=o[e];if(t(this).is(".add"))n.amount++;else{if(n.amount<=1)return;n.amount--}t.cookie("products",o,{expires:7,path:"/"}),c.find(".amount_num").val(n.amount),c.children(".sub").text(n.amount*n.price),r()}),t(".cart_body").on("blur",".amount_num",function(){var c=t(this).parents(".product"),e=i(c.children(".id").text(),o),n=o[e];/^[1-9]\d*$/.test(t(this).val())?(n.amount=t(this).val(),t.cookie("products",o,{expires:7,path:"/"}),c.children(".sub").text(n.amount*n.price),r()):t(this).val(n.amount)}),t(".ck_all").click(function(){var c=t(this).prop("checked");t(".ck_product").prop("checked",c),r()}),t(".ck_product").click(function(){var c=t(".ck_product:checked").length===o.length;t(".ck_all").prop("checked",c),r()}),t("#sub").click(function(){var c="您购买的商品总价为<span>"+r()+'</span>元,是否购买？\n\t\t\t\t\t<button class="close">close</button>\n\t\t\t\t\t<button class="confirm">确认</button>\n\t\t\t\t\t';t(".get_money").show(),t(".get_money").html(c),t(".close").click(function(){t(".get_money").hide()}),t(".confirm").click(function(){t(".get_money").html("购买成功"),setTimeout(function(){t(".get_money").hide(),location="/index.html"},3e3)})})}else t(".cart_body").html('购物车为空,请<a href="list.html">选购商品</a>');function i(c,e){var o=-1;return t.each(e,function(t,e){if(e.id==c)return o=t,!1}),o}function r(){var c=0;return t(".ck_product:checked").each(function(e,o){c+=Number(t(this).parents(".product").children(".sub").text())}),t(".total .money").text(c.toFixed(2)),c}})});